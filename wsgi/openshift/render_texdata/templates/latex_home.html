{% extends "admin/change_list.html" %}

{% load i18n admin_urls %}
{% block object-tools-items %}
</ul>
</header>

<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>

<script>
    function switchContest()
    {
        window.document.location = $('select[name="selectContest"] option:selected').val();
  }
</script>

<h2> Choose contest </h2>
<select name="selectContest" onchange="switchContest()">
    {% for con in contests %}
        {% if con.pk == contest.pk %}
            <option selected value = "con{{con.pk}}">{{con.title}}</option>
        {% else %}
            <option value = "con{{con.pk}}">{{con.title}}</option>
        {%endif %}
    {% endfor %}
</select>

<br />
<br />

<h2>Subsitution pattern: anywhere in your tex-code, 3 forward slashes followed by VARIABLE, e.g.  ///TEAM </h2>
<h4>All variables below are optional</h4>
<ul>
    <li>TEAM - name of selected team</li>
    <li>CONTESTANT1 - leader of team</li>
    <li>CONTESTANT2 - member of team, if any</li>
    <li>CONTESTANT3 - member of team, if any</li>
    <li>SPONSOR - image and title of sponsors (can only be used with \documentclass{article}</li>
    <li>CONTEST_LOGO - absolute filename to contest logo - not rendered</li>
</ul>

<br />
<br />
<h3>(Please use \documentclass{article}.... Using {letter} breaks image alignments)</h3>
<textarea id="id_latex" rows="14" cols="450">
\documentclass[a4paper]{article}
\usepackage{graphicx}
\usepackage[absolute]{textpos}

\begin{document}
\pagestyle{empty}

%********************************
%copy fra her
%********************************
\begin{center}

\vspace*{-4cm}
% \includegraphics[scale=0.4]{Logo_paper_cropped(edit).png}

\vspace*{2cm}

%******************
% Navn skal inn her
%******************
{\Huge \bf ///TEAM} \\*
\vspace*{0.7cm}
{\Huge ///CONTESTANT1}\\*
\vspace*{0.5cm}
{\Huge ///CONTESTANT2}\\*
\vspace*{0.5cm}
{\Huge ///CONTESTANT3}\\*

\end{center}


\begin{textblock}{1}[4,-1](10, 10)
% \includegraphics[scale=0.35]{pizzabrus.png}
\end{textblock}

///SPONSOR

\newpage

%********************************
%copy til hit
%********************************


% http://handyfloss.wordpress.com/2007/05/29/latex-the-textpos-package/
% \begin{textblock}{width}[xt,yt](X,Y)  the-text-goes-here  \end{textblock}

%{\ae}=æ
%{\o}=ø
%{\aa}=å

\end{document}
</textarea>




{% if semicolon_list %}    
<textarea rows="10">
{{semicolon_list}}
    </textarea>
{% endif %}


<script type="text/javascript">
        function post_to_url(path, params, buttonID) {
                var form = document.createElement("form");
                form.setAttribute("action", path);
                form.setAttribute("method", "POST");
                
                var csrf_field = document.createElement("input");
                csrf_field.setAttribute("type", "hidden");
                csrf_field.setAttribute("name", "csrfmiddlewaretoken");
                csrf_field.setAttribute("value", "{{ csrf_token }}");
                form.appendChild(csrf_field);

                var button_id = document.createElement("input");
                button_id.setAttribute("type", "hidden");
                button_id.setAttribute("name", "buttonId");
                button_id.setAttribute("value", buttonID);
                form.appendChild(button_id);



                checkboxes = document.getElementsByName("_selected_action");

                var teams = [];
                var hiddenField = document.createElement("input");
                hiddenField.setAttribute("type", "hidden");
                for(var iPos = 0; iPos < checkboxes.length; iPos++)
                {


                    if (checkboxes[iPos].checked == true)
                    {
                        teams.push(checkboxes[iPos].value);
                    }

                }
                hiddenField.setAttribute("name", "teams");
                hiddenField.setAttribute("value", teams);
                form.appendChild(hiddenField)

                for ( var key in params) {
                        if (params.hasOwnProperty(key)) {
                                var hiddenField = document.createElement("input");
                                hiddenField.setAttribute("type", "hidden");
                                hiddenField.setAttribute("name", key);
                                hiddenField.setAttribute("value", params[key]);

                                form.appendChild(hiddenField);
                        }
                }
                document.body.appendChild(form);
                form.submit();
        }
</script>

<style>
button.buttonGroup  {
    width : auto;
    margin : 4px;
    padding : 4px 15px;
    color : #1A1717;
    }
</style>

<button type="submit" class="buttonGroup" onclick="post_to_url('', {'text':document.getElementById('id_latex').value}, 'teamCSV_onePDF')">Create latex for teams (one pdf)</button>


<button type="submit" class="buttonGroup" onclick="post_to_url('', {'text':document.getElementById('id_latex').value}, 'teamCSV_manyPDF')">Create latex for teams (several pdf)</button>

<button type="submit" class="buttonGroup" onclick="post_to_url('', {}, 'emailCSV')">Create list of emails</button>


<br />
<br />

{% endblock %}
