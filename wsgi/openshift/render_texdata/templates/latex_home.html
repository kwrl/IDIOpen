{% extends "admin/change_list.html" %}

{% load i18n admin_urls %}
{% block object-tools-items %}
</ul>
</header>
<h3>Variables that will be replaced if given. Not including the below variables gives default empty strings</h3>
<ul>
    <li>%(team)s - will be subsituted with team name for each selected team</li>
    <li>%(contestant_line)s - will be substituted with a comma-separated line with commas</li>
    <li>%(sponsor1)s, - will be replaced by company logo </li>
    <li>%(sponsor1)s</li>
    <li>%(sponsor1)s</li>
    <li>%(prize) - prize title for team</li>
</ul>

<textarea id="id_latex" rows="14" cols="450">
\documentclass{article}
\begin{document}
%(team)s \\
%(contestant_line)s
%(sponsor1)s
%(sponsor2)s
%(sponsor3)s
%(prize)s
\end{document}
</textarea>

{% if semicolon_list %}    
<textarea rows="10">
{{semicolon_list}}
    </textarea>
{% endif %}

<script type="text/javascript">
        function post_to_url(path, params, buttonID) {
                var form = document.createElement("form");
                form.setAttribute("action", path);
                form.setAttribute("method", "POST");
                
                var csrf_field = document.createElement("input");
                csrf_field.setAttribute("type", "hidden");
                csrf_field.setAttribute("name", "csrfmiddlewaretoken");
                csrf_field.setAttribute("value", "{{ csrf_token }}");
                form.appendChild(csrf_field);

                var button_id = document.createElement("input");
                button_id.setAttribute("type", "hidden");
                button_id.setAttribute("name", "buttonId");
                button_id.setAttribute("value", buttonID);
                form.appendChild(button_id);



                checkboxes = document.getElementsByName("_selected_action");

                var teams = [];
                var hiddenField = document.createElement("input");
                hiddenField.setAttribute("type", "hidden");
                for(var iPos = 0; iPos < checkboxes.length; iPos++)
                {


                    if (checkboxes[iPos].checked == true)
                    {
                        teams.push(checkboxes[iPos].value);
                    }

                }
                hiddenField.setAttribute("name", "teams");
                hiddenField.setAttribute("value", teams);
                form.appendChild(hiddenField)

                for ( var key in params) {
                        if (params.hasOwnProperty(key)) {
                                var hiddenField = document.createElement("input");
                                hiddenField.setAttribute("type", "hidden");
                                hiddenField.setAttribute("name", key);
                                hiddenField.setAttribute("value", params[key]);

                                form.appendChild(hiddenField);
                        }
                }
                document.body.appendChild(form);
                form.submit();
        }
</script>

<style>
button.buttonGroup  {
    width : auto;
    margin : 4px;
    padding : 4px 15px;
    color : #1A1717;
    }
</style>

<button type="submit" class="buttonGroup" onclick="post_to_url('', {'text':document.getElementById('id_latex').value}, 'teamCSV')">Create latex for teams</button>


<button type="submit" class="buttonGroup" onclick="post_to_url('', {}, 'emailCSV')">Create list of emails</button>

{% endblock %}
