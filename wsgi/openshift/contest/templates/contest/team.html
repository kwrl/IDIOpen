{% extends 'base.html' %}
{% load i18n %}
{% load link_tags %}
{% block content %}

{% if team %}

	
	<div class="row">
		<div class="col-lg-9">
			<h2>Team page</h2>
		</div>
		{% if is_leader %}    
		<div class="col-lg-3">
			<a href="{%Â url 'team_edit' contest.url %}" class="btn btn-primary btn-sm pull-right">{% trans 'Edit team' %}</a>
		</div>
		{% endif %}
		<div class="col-lg-3">
			<a href=# id="LeaveButton" data-toggle="confirmation" class="alert btn btn-danger btn-sm pull-right">{% trans 'Leave team' %}</a>
        {# btn btn-primary btn-sm pull-right">{% trans 'Leave team' %}</a> #}
		</div>
	</div>


	<hr>
	<em><h3> {{ team.name }}</h3></em>
	<p class="text-muted">
	Location: 
	{% if team.onsite %}
		Onsite
	{% else %}
		{{ team.offsite }}
	{% endif %}
	</p>
	<hr>
	<em><h4>Members</h4></em>
	<table class="table table-striped">
      <thead>
        <tr>
          <th>First Name</th>
          <th>Last Name</th>
          <th>Email</th>
        </tr>
      </thead>
        <tbody>
        {% for member in team.members.all %}
        <tr>
          <td><a href="#">{{ member.first_name }}</a></td>
          <td><a href="#">{{ member.last_name }}</a></td>
          <td><a href="#">{{ member.email }}</a></td>
        </tr>
		{% endfor %}
      </tbody>
    </table>
	{% if is_leader %}    
	<form class="form-horizontal" method="POST" action="" role="form">
	{% csrf_token %}
		<div class="form-group">
            {{ addMemberForm.email.errors }}
            <label for="{{ field.id_for_label }}" class="col-lg-3 control-label">
            {{ addMemberForm.email.label }}</label> 
            <div class="col-lg-5">
            {{ addMemberForm.email|addcss:"form-control"}}
            </div>
        </div>
	    <div class="form-group">
			<div class="col-lg-offset-3 col-lg-9">
	  			<button type="submit" name='addMember' value="addMember" class="btn btn-default">{% trans 'Add new member' %}</button>
	  		</div>
  		</div>
	</form>

    <script src="https://github.com/makeusabrew/bootbox/releases/download/v4.2.0/bootbox.min.js"></script>
    <script>
        $(document).on("click", ".alert", function(e) {
             bootbox.dialog( 
             {
                message: "Are you sure?",
                title:"Leaving team - confirmation", 
                buttons: 
                { 
                    cancel:
                    {
                        label:"No - cancel",
                        className: "btn-primary",
                    },
                    confirmLeave: 
                    {
                        label:"Yes - leave team",
                        className: "btn-danger",
                        callback: function() {
                            document.location.href = "{% url 'team_leave' contest.url %}";
                         }
                    }, 
                } 
            });
         });
    </script>
	{% endif %}
{% else %}
	<p> You are currently not member of any team. Want to participate in this contest? </p>
	<a href=" {% url 'register_teams' contest.url %}">Registrer Team </a>

{% endif %}	

{% endblock content %}
