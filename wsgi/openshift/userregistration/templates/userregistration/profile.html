{% extends 'base.html' %}
{% block content %}

	<h2> Profile page</h2>
	<hr>
	<em><p style="font-size: 250%;">{{ user.first_name }} {{ user.last_name }} </p></em>
	{% if team %}
	<em><p style="font-size: 200%;">{{ team.name }}</p></em>
	{% else %}
	{{ team }}
	{% endif %}
	<br>    
	Email:<em> {{ user.email }}</em>
	<br>
	Date joined:<em> {{ user.date_joined|date:"d.m.Y"}}</em>
	</p>
	<br>
<hr>
<link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
  <script src="//code.jquery.com/jquery-1.9.1.js"></script>
  <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
  <link rel="stylesheet" href="/resources/demos/style.css">


    {% if userpw.errors %}
        <script>$(document).ready( function () {
            document.getElementById("collapsePw").classList.add("in");
            });
        </script>
    {% endif %}
    {% if useremail.errors %}
        <script>$(document).ready( function () {
            document.getElementById("collapseEmail").classList.add("in");
            });
        </script>
    {% endif %}
    {% if userpi.errors %}
        <script>$(document).ready( function () {
            document.getElementById("collapsePI").classList.add("in");
            });
        </script>
    {% endif %}
	
<div class="panel-group" id="accordion">
    <div class="panel panel-default">
        <div class="panel-heading">
        <a data-toggle="collapse" data-parent="#accordion" href="#collapsePw">
            <h4 class="panel-title">
                    Change password
            </h4>
            </a>
        </div>
        <div id="collapsePw" class="panel-collapse collapse ">
            <div class="panel-body">
                <form id="contestant_edit_pw" METHOD="POST" action="../profileEditPw/">
                {% csrf_token %}
                    {% for field in userpw %}
                        {{ field.label_tag }} {{ field }}
                        {{ field.errors }}
                        <br />
                    {% endfor %}
                    <button type="submit" name="submit" value="Save" class="btn btn-default btn-sm">
                        Change password
                    </button>
                </form>
            </div>
        </div>
        <div class="panel-heading">
        <a data-toggle="collapse" data-parent="#accordion" href="#collapseEmail">
            <h4 class="panel-title">
                    Change email
            </h4>
            </a>
        </div>
        <div id="collapseEmail" class="panel-collapse collapse">
            <div class="panel-body">
                <form id="contestant_edit_pw" METHOD="POST" action="../profileEditEmail/">
                {% csrf_token %}
                    {% for field in useremail %}
                        {{ field.label_tag }} {{ field }}
                        {{ field.errors }}
                        <br />
                    {% endfor %}
                    <button type="submit" name="submit" value="Save" class="btn btn-default btn-sm">
                        Change email
                    </button>
                </form>
            </div>
        </div>
         <div class="panel-heading">
         <a data-toggle="collapse" data-parent="#accordion" href="#collapsePI">
            <h4 class="panel-title">
                    Change user information
            </h4>
            </a>
        </div>
        <div id="collapsePI" class="panel-collapse collapse">
            <div class="panel-body">
                <form id="contestant_edit_pw" METHOD="POST" action="../profileEditPI/">
                {% csrf_token %}
                    {% for field in userpi %}
                        {{ field.label_tag }} {{ field }}
                        {{ field.errors }}
                        <br />
                    {% endfor %}
                    <button type="submit" name="submit" value="Save" class="btn btn-default btn-sm">
                        Update user information
                    </button>
                </form>
            </div>
        </div>


    </div>
</div>
	
	<hr>
	<h1>List over invites: </h1>
	{% if invites %}
		{% if have_team %}
			<p> You already have a team </p>
		{% endif %}
			{% for invite in invites.all %}
				<p>{{ invite }}</p>
				<form action="." method="post"> {% csrf_token %}
				<input type="hidden" value="{{ invite.id }}" name="id">
				{% if have_team %}
					<button type="submit" name="submit" value="accept" disabled="disabled" class="btn btn-default btn-sm">Accept</button>
				{% elif invite.team.members.count >= 3 %}
				<p>This team has reached the maximum number of members</p>
				<button type="submit" name="submit" disabled="disabled" value="accept" class="btn btn-default btn-sm">Accept</button>
				{% else %}
				<button type="submit" name="submit" value="accept" class="btn btn-default btn-sm">Accept</button>
				{% endif %}
				<button type="submit" name="submit" value="decline" class="btn btn-default btn-sm">Decline</button>
				</form>
			{% endfor %}
	{% else %}
		<p> You have no invites :( <p>
	{% endif %}
{% endblock content %}
